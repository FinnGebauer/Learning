SELECT *
FROM state_climate
LIMIT 5;

/* SELECT
  state,
  year,
  tempc,
  AVG(tempc) OVER (
    PARTITION BY state
    ORDER BY year
  ) running_avg_temp
FROM
  state_climate; */


 /*  SELECT
  state,
  year,
  tempc,
  FIRST_VALUE(tempc) OVER (
    PARTITION BY state
    ORDER BY tempc
  ) lowest_temp
FROM
  state_climate; */

/* SELECT
  state,
  year,
  tempc,
  LAST_VALUE(tempc) OVER (
    PARTITION BY state
    ORDER BY tempc
    RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
  ) highest_temp
FROM
  state_climate; */

/* SELECT
  state,
  year,
  tempc,
  tempc - LAG(tempc, 1, tempc) OVER (
    PARTITION BY state
    ORDER BY year
  ) AS change_in_temp
FROM
  state_climate
ORDER BY 
  change_in_temp DESC; */

/* SELECT
  state,
  year,
  tempc,
  RANK() OVER (
    ORDER BY tempc
  ) AS coldest_rank
FROM
  state_climate; */

/* SELECT
  state,
  year,
  tempc,
  RANK() OVER (
    PARTITION BY state
    ORDER BY tempc DESC
  ) AS warmest_rank
FROM
  state_climate; */

/* SELECT
  state,
  year,
  tempc,
  NTILE(4) OVER (
    PARTITION BY state
    ORDER BY tempc ASC
  ) AS temp_quartiles
FROM
  state_climate; */

SELECT
  state,
  year,
  tempc,
  NTILE(5) OVER (
    ORDER BY tempc ASC
  ) AS temp_quintiles
FROM
  state_climate;
